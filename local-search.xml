<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>通过RMAN方式搭建Oracle 10G DataGuard</title>
    <link href="/2021/08/23/%E9%80%9A%E8%BF%87RMAN%E6%96%B9%E5%BC%8F%E6%90%AD%E5%BB%BAOracle-10G-DataGuard/"/>
    <url>/2021/08/23/%E9%80%9A%E8%BF%87RMAN%E6%96%B9%E5%BC%8F%E6%90%AD%E5%BB%BAOracle-10G-DataGuard/</url>
    
    <content type="html"><![CDATA[<h1 id="通过RMAN方式搭建Oracle-10G-DataGuard"><a href="#通过RMAN方式搭建Oracle-10G-DataGuard" class="headerlink" title="通过RMAN方式搭建Oracle 10G DataGuard"></a>通过RMAN方式搭建Oracle 10G DataGuard</h1><blockquote><p>如有错误之处，恳请指正。</p></blockquote><p>[TOC]</p><h3 id="步骤总结"><a href="#步骤总结" class="headerlink" title="步骤总结"></a>步骤总结</h3><ol><li>standby系统配置</li><li>打包软件并拷贝</li><li>解压后的操作</li><li>主库参数修改及备份</li><li>备库参数修改及还原</li><li>开启日志应用</li><li>问题处理</li></ol><h3 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h3><p><strong>primary</strong>：</p><p>​        version：Oracle 10g 10.2.0.3</p><p>​        instance_name：member</p><p>​        db_unique_name：MEMSTD2</p><p>​        OS：CentOS 5.6</p><p><strong>standby:</strong></p><p>​        version：Oracle 10g 10.2.0.3</p><p>​        instance_name：memberdg</p><p>​        db_unique_name：MEMBERDG</p><p>​        OS：CentOS 5.6</p><h3 id="standby配置"><a href="#standby配置" class="headerlink" title="standby配置"></a>standby配置</h3><ol><li><strong>操作系统参数调整</strong></li></ol><p>略。正常配置即可。</p><ol start="2"><li><strong>添加用户和组</strong></li></ol><p><code>groupadd oinstall</code></p><p><code>groupadd dba</code></p><p><code>useradd -g oinstall -G dba oracle</code></p><p><code>passwd oracle</code></p><ol start="3"><li><strong>修改.bash_profile</strong></li></ol><p>从primary拷贝过来</p><p><code>scp ~/.bash_profile standby:$PWD</code></p><p>也可手动修改</p><h3 id="打包软件并拷贝"><a href="#打包软件并拷贝" class="headerlink" title="打包软件并拷贝"></a>打包软件并拷贝</h3><ol><li><strong>打包软件</strong></li></ol><p><code>tar -zcpf oracle.tar.gz /oracle</code></p><ol start="2"><li><strong>传输文件</strong></li></ol><p><code>scp oracle.tar.gz standby:/data/software</code></p><ol start="3"><li><strong>解压软件</strong></li></ol><p><code>tar -zxf oracle.tar.gz -C /oracle</code></p><ol start="4"><li><strong>权限管理</strong></li></ol><p>打包文件本身包含了权限，如果有问题也可以手动修改</p><p><code>chown -R oracle:oinstall /oracle</code></p><ol start="5"><li><strong>执行脚本</strong></li></ol><p><strong>oralce</strong>用户下执行：</p><p><code>relink all</code></p><p><code>sh $ORACLE_HOME/install/changePerm.sh</code></p><p><strong>root</strong>用户下执行：</p><p><code>sh $ORACLE_HOME/root.sh</code></p><h3 id="主库参数修改及备份"><a href="#主库参数修改及备份" class="headerlink" title="主库参数修改及备份"></a>主库参数修改及备份</h3><p>下列操作如未特别说明，默认在主库操作</p><ol><li><strong>开启强制日志记录</strong></li></ol><p>保证DataGuard的可恢复性，强制数据库在任何状态下都必须记录日志</p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> force_logging <span class="hljs-keyword">from</span> v$database;<span class="hljs-comment">-- 返回值为NO，则执行该语句开启</span><span class="hljs-keyword">alter</span> database force logging;</code></pre></div><ol start="2"><li><strong>修改参数文件</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> LOG_ARCHIVE_CONFIG<span class="hljs-operator">=</span><span class="hljs-string">&#x27;DG_CONFIG=(MEMSTD2,MEMBERDG)&#x27;</span>;<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> LOG_ARCHIVE_DEST_2<span class="hljs-operator">=</span><span class="hljs-string">&#x27;SERVICE=MEMBERDG LGWR ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLES) DB_UNIQUE_NAME=MEMBERDG&#x27;</span>;<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> LOG_ARCHIVE_DEST_STATE_1<span class="hljs-operator">=</span>ENABLE;<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> LOG_ARCHIVE_DEST_STATE_2<span class="hljs-operator">=</span>ENABLE;</code></pre></div><ol start="3"><li><strong>修改tnsnames.ora配置</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-comment">-- 添加以下内容</span><span class="hljs-keyword">MEMBER</span> <span class="hljs-operator">=</span>  (DESCRIPTION <span class="hljs-operator">=</span>    (ADDRESS <span class="hljs-operator">=</span> (PROTOCOL <span class="hljs-operator">=</span> TCP)(HOST <span class="hljs-operator">=</span> <span class="hljs-keyword">primary</span>)(PORT <span class="hljs-operator">=</span> <span class="hljs-number">1521</span>))    (CONNECT_DATA <span class="hljs-operator">=</span>      (SERVER <span class="hljs-operator">=</span> DEDICATED)      (SERVICE_NAME <span class="hljs-operator">=</span> member1)    )  )MEMBERDG <span class="hljs-operator">=</span>  (DESCRIPTION <span class="hljs-operator">=</span>    (ADDRESS_LIST <span class="hljs-operator">=</span>      (ADDRESS <span class="hljs-operator">=</span> (PROTOCOL <span class="hljs-operator">=</span> TCP)(HOST <span class="hljs-operator">=</span> standby)(PORT <span class="hljs-operator">=</span> <span class="hljs-number">1521</span>))    )    (CONNECT_DATA <span class="hljs-operator">=</span>      (SERVER <span class="hljs-operator">=</span> DEDICATED)      (SERVICE_NAME <span class="hljs-operator">=</span> memberdg)    )  )</code></pre></div><ol start="4"><li><strong>创建standby redo log</strong></li></ol><p>建议比online redo log多一组，size相同</p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">21</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2101.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">22</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2201.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">23</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2301.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">24</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2401.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">25</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2501.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">26</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2601.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">27</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2701.log&#x27;</span>) size <span class="hljs-number">500</span>m;</code></pre></div><ol start="5"><li><strong>使用rman备份主库</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql">rman target <span class="hljs-operator">/</span>run&#123;<span class="hljs-keyword">allocate</span> channel ch1 device type disk;<span class="hljs-keyword">allocate</span> channel ch2 device type disk;<span class="hljs-keyword">allocate</span> channel ch3 device type disk;<span class="hljs-keyword">allocate</span> channel ch4 device type disk;<span class="hljs-keyword">allocate</span> channel ch5 device type disk;<span class="hljs-keyword">allocate</span> channel ch6 device type disk;<span class="hljs-keyword">allocate</span> channel ch7 device type disk;<span class="hljs-keyword">allocate</span> channel ch8 device type disk;backup DATABASE include <span class="hljs-keyword">CURRENT</span> controlfile format <span class="hljs-string">&#x27;/data1/backup/member_%d_%T_%s_%p&#x27;</span>;<span class="hljs-keyword">release</span> channel ch1;<span class="hljs-keyword">release</span> channel ch2;<span class="hljs-keyword">release</span> channel ch3;<span class="hljs-keyword">release</span> channel ch4;<span class="hljs-keyword">release</span> channel ch5;<span class="hljs-keyword">release</span> channel ch6;<span class="hljs-keyword">release</span> channel ch7;<span class="hljs-keyword">release</span> channel ch8;&#125;</code></pre></div><ol start="6"><li><strong>拷贝备份文件至standby</strong></li></ol><p><code>scp /data1/backup/* standby:$PWD</code></p><h3 id="备库参数修改及还原"><a href="#备库参数修改及还原" class="headerlink" title="备库参数修改及还原"></a>备库参数修改及还原</h3><p>下列操作如未特别说明，默认在主库操作</p><ol><li><strong>参数文件配置</strong></li></ol><p>在<strong>primary</strong>生成pfile参数文件</p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> pfile <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;/data1/backup/pfile.ora&#x27;</span> <span class="hljs-keyword">from</span> spfile;</code></pre></div><p>拷贝至standby</p><p><code>scp /data1/backup/pfile.ora standby:/data/backup/</code></p><p><strong>standby</strong>生成spfile文件</p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> spfile <span class="hljs-keyword">from</span> pfile <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;/data/backup/pfile.ora&#x27;</span>;</code></pre></div><p>手动创建参数文件中指定的audit_file_dest、background_dump_dest、core_dump_dest、db_recovery_file_dest、user_dump_dest等目录</p><p>启动实例至nomount</p><div class="hljs code-wrapper"><pre><code class="hljs sql">startup nomount</code></pre></div><p>修改备库参数</p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> db_unique_name <span class="hljs-operator">=</span> memberdg <span class="hljs-keyword">scope</span><span class="hljs-operator">=</span>spfile;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> log_archive_config<span class="hljs-operator">=</span><span class="hljs-string">&#x27;DG_CONFIG=(MEMSTD2,MEMBERDG)&#x27;</span>;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> LOG_ARCHIVE_DEST_2<span class="hljs-operator">=</span><span class="hljs-string">&#x27;SERVICE=MEMSTD2 LGWR ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=MEMSTD2&#x27;</span>;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> LOG_ARCHIVE_DEST_STATE_1<span class="hljs-operator">=</span>ENABLE;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> LOG_ARCHIVE_DEST_STATE_2<span class="hljs-operator">=</span>DEFER;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> remote_login_passwordfile<span class="hljs-operator">=</span><span class="hljs-string">&#x27;EXCLUSIVE&#x27;</span> <span class="hljs-keyword">scope</span><span class="hljs-operator">=</span>spfile;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> DB_FILE_NAME_CONVERT<span class="hljs-operator">=</span><span class="hljs-string">&#x27;/data/member/&#x27;</span>,<span class="hljs-string">&#x27;/data/memberdg/&#x27;</span>,<span class="hljs-string">&#x27;/data1/member/&#x27;</span>,<span class="hljs-string">&#x27;/data/memberdg/&#x27;</span> <span class="hljs-keyword">scope</span><span class="hljs-operator">=</span>spfile;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">set</span> LOG_FILE_NAME_CONVERT<span class="hljs-operator">=</span><span class="hljs-string">&#x27;/data/member/&#x27;</span>,<span class="hljs-string">&#x27;/data/memberdg/&#x27;</span>,<span class="hljs-string">&#x27;/data1/member/&#x27;</span>,<span class="hljs-string">&#x27;/data/memberdg/&#x27;</span> <span class="hljs-keyword">scope</span><span class="hljs-operator">=</span>spfile;</code></pre></div><p><code>shutdown</code></p><ol start="2"><li><strong>配置控制文件</strong></li></ol><p><strong>primary</strong>执行</p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> database <span class="hljs-keyword">create</span> standby controlfile <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;/data1/backup/ctl.bak&#x27;</span>;</code></pre></div><p><code>scp /data1/backup/ctl.bak standby:/data/backup/</code></p><p>备库将该文件拷贝至对应目录并改名</p><p>将备库起到mount状态</p><div class="hljs code-wrapper"><pre><code class="hljs sql">startup mount</code></pre></div><ol start="3"><li><strong>使用rman进行还原</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql">rman target <span class="hljs-operator">/</span>catalog <span class="hljs-keyword">start</span> <span class="hljs-keyword">with</span> <span class="hljs-string">&#x27;/data/backup/&#x27;</span>;run&#123;<span class="hljs-keyword">allocate</span> channel ch1 device type disk;<span class="hljs-keyword">allocate</span> channel ch2 device type disk;<span class="hljs-keyword">allocate</span> channel ch3 device type disk;<span class="hljs-keyword">allocate</span> channel ch4 device type disk;<span class="hljs-keyword">allocate</span> channel ch5 device type disk;<span class="hljs-keyword">allocate</span> channel ch6 device type disk;<span class="hljs-keyword">allocate</span> channel ch7 device type disk;<span class="hljs-keyword">allocate</span> channel ch8 device type disk;restore database;<span class="hljs-keyword">release</span> channel ch1;<span class="hljs-keyword">release</span> channel ch2;<span class="hljs-keyword">release</span> channel ch3;<span class="hljs-keyword">release</span> channel ch4;<span class="hljs-keyword">release</span> channel ch5;<span class="hljs-keyword">release</span> channel ch6;<span class="hljs-keyword">release</span> channel ch7;<span class="hljs-keyword">release</span> channel ch8;&#125;</code></pre></div><ol start="4"><li><strong>创建standby redo log</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">21</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2101.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">22</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2201.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">23</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2301.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">24</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2401.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">25</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2501.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">26</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2601.log&#x27;</span>) size <span class="hljs-number">500</span>m;<span class="hljs-keyword">alter</span> database <span class="hljs-keyword">add</span> standby logfile <span class="hljs-keyword">group</span> <span class="hljs-number">27</span> (<span class="hljs-string">&#x27;/data/memberdg/std_log_2701.log&#x27;</span>) size <span class="hljs-number">500</span>m;</code></pre></div><ol start="5"><li><strong>修改tnsnames.ora</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">MEMBER</span> <span class="hljs-operator">=</span>  (DESCRIPTION <span class="hljs-operator">=</span>    (ADDRESS <span class="hljs-operator">=</span> (PROTOCOL <span class="hljs-operator">=</span> TCP)(HOST <span class="hljs-operator">=</span><span class="hljs-number">162.14</span><span class="hljs-number">.136</span><span class="hljs-number">.65</span>)(PORT <span class="hljs-operator">=</span> <span class="hljs-number">1521</span>))    (CONNECT_DATA <span class="hljs-operator">=</span>      (SERVER <span class="hljs-operator">=</span> DEDICATED)      (SERVICE_NAME <span class="hljs-operator">=</span> member1)    )  )MEMBERDG <span class="hljs-operator">=</span>  (DESCRIPTION <span class="hljs-operator">=</span>    (ADDRESS_LIST <span class="hljs-operator">=</span>      (ADDRESS <span class="hljs-operator">=</span> (PROTOCOL <span class="hljs-operator">=</span> TCP)(HOST <span class="hljs-operator">=</span> <span class="hljs-number">162.14</span><span class="hljs-number">.135</span><span class="hljs-number">.231</span>)(PORT <span class="hljs-operator">=</span> <span class="hljs-number">1521</span>))    )    (CONNECT_DATA <span class="hljs-operator">=</span>      (SERVER <span class="hljs-operator">=</span> DEDICATED)      (SERVICE_NAME <span class="hljs-operator">=</span> memberdg)    )  )</code></pre></div><ol start="6"><li><strong>开启force logging</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> force_logging <span class="hljs-keyword">from</span> v$database;<span class="hljs-keyword">alter</span> database force logging;</code></pre></div><ol start="7"><li><strong>添加静态监听</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql">SID_LIST_LISTENER <span class="hljs-operator">=</span> (SID_LIST <span class="hljs-operator">=</span>      (SID_DESC <span class="hljs-operator">=</span>        (GLOBAL_DBNAME <span class="hljs-operator">=</span> MEMBERDG)        (ORACLE_HOME <span class="hljs-operator">=</span> <span class="hljs-operator">/</span>oracle<span class="hljs-operator">/</span>app<span class="hljs-operator">/</span>product<span class="hljs-operator">/</span><span class="hljs-number">10.0</span><span class="hljs-number">.2</span><span class="hljs-operator">/</span>db_1)        (SID_NAME <span class="hljs-operator">=</span> memberdg)      ))</code></pre></div><h3 id="开启日志应用"><a href="#开启日志应用" class="headerlink" title="开启日志应用"></a>开启日志应用</h3><ol><li><strong>tnsping检查主备通信</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql">tnsping <span class="hljs-keyword">primary</span>tnsping standby</code></pre></div><ol start="2"><li><strong>备库开启日志应用</strong></li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> database recover managed standby database <span class="hljs-keyword">using</span> <span class="hljs-keyword">current</span> logfile <span class="hljs-keyword">disconnect</span> <span class="hljs-keyword">from</span> session ;</code></pre></div><ol start="3"><li>检查应用情况</li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-comment">-- 检查alert日志</span><span class="hljs-comment">-- 检查进程</span><span class="hljs-keyword">select</span> process,status,sequence#,block# <span class="hljs-keyword">from</span> gv$managed_standby;</code></pre></div><h3 id="问题处理"><a href="#问题处理" class="headerlink" title="问题处理"></a>问题处理</h3><ol><li><strong>alert日志报错如下：</strong></li></ol><p><img src="https://gitee.com/coveyzy/imgs/raw/master/img/202108231422599.png" alt="image-20210823142243851"></p><p><strong>解决办法：</strong></p><p>如果设置有<code>fal_client</code>和<code>fal_server</code>参数，DG会自动寻找缺失的日志，前提是日志文件没被覆盖或归档文件还在。</p><p>这里因为归档已经不在了，只能通过基于SCN的增量备份后进行恢复，具体步骤如下：</p><p>（1）<strong>确定SCN</strong></p><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-comment">-- 执行以下语句，哪个值小就从哪个开始增备</span><span class="hljs-keyword">select</span> <span class="hljs-built_in">min</span>(first_nonlogged_scn) <span class="hljs-keyword">from</span> v$datafile <span class="hljs-keyword">where</span> first_nonlogged_scn <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>;<span class="hljs-comment">-- 可能不会有返回值，则以下面的返回值为开始SCN</span><span class="hljs-keyword">select</span> current_scn <span class="hljs-keyword">from</span> v$database;</code></pre></div><p>（2）<strong>主库执行增量备份</strong></p><div class="hljs code-wrapper"><pre><code class="hljs sql">backup incremental <span class="hljs-keyword">from</span> scn <span class="hljs-number">48310199829</span> database format <span class="hljs-string">&#x27;/data1/backup/archivedlog_%U&#x27;</span>;<span class="hljs-comment">-- 备份控制文件</span>backup <span class="hljs-keyword">current</span> controlfile <span class="hljs-keyword">for</span> standby format <span class="hljs-string">&#x27;/data1/backup/controlfile.bak&#x27;</span>;</code></pre></div><p>（3）<strong>恢复数据库</strong></p><div class="hljs code-wrapper"><pre><code class="hljs sql">recover database noredo;restore standby controlfile <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;/data/backup/controlfile.bak&#x27;</span>;</code></pre></div><p>（4）<strong>重新开启日志应用</strong></p><ol start="2"><li><strong>备库需要手动创建standby redo log</strong></li></ol><p><img src="https://gitee.com/coveyzy/imgs/raw/master/img/202108231437761.png" alt="image-20210823143745687"></p><p>还有一些小问题，没有及时记录，就不bb了。</p>]]></content>
    
    
    <categories>
      
      <category>DataGuard</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oracle DataGuard</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/08/12/arch-sql/"/>
    <url>/2021/08/12/arch-sql/</url>
    
    <content type="html"><![CDATA[<h5 id="arch-sql"><a href="#arch-sql" class="headerlink" title="arch.sql"></a>arch.sql</h5><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> lines <span class="hljs-number">400</span><span class="hljs-keyword">set</span> pages <span class="hljs-number">999</span>col avg <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col total_gb <span class="hljs-keyword">for</span> <span class="hljs-number">999999</span>col     h0      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h1      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h2      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h3      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h4      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h5      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h6      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h7      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h8      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h9      <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h10     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h11     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h12     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h13     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h14     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h15     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h16     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h17     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h18     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h19     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h20     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h21     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h22     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span>col     h23     <span class="hljs-keyword">for</span> <span class="hljs-number">999</span><span class="hljs-keyword">WITH</span> t1 <span class="hljs-keyword">AS</span> (<span class="hljs-keyword">SELECT</span> TO_CHAR(FIRST_TIME, <span class="hljs-string">&#x27;yyyy/mm/dd&#x27;</span>) time_day,ROUND(<span class="hljs-built_in">SUM</span>(BLOCKS <span class="hljs-operator">*</span> BLOCK_SIZE) <span class="hljs-operator">/</span> <span class="hljs-number">1048576</span> <span class="hljs-operator">/</span> <span class="hljs-number">1024</span>) size_gb  <span class="hljs-keyword">FROM</span> V$ARCHIVED_LOG <span class="hljs-keyword">WHERE</span> CREATOR <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;ARCH&#x27;</span> <span class="hljs-keyword">AND</span> STANDBY_DEST <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;NO&#x27;</span> <span class="hljs-keyword">AND</span> FIRST_TIME <span class="hljs-operator">&gt;=</span> TRUNC(SYSDATE) <span class="hljs-operator">-</span> <span class="hljs-number">92</span> <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> TO_CHAR(FIRST_TIME, <span class="hljs-string">&#x27;yyyy/mm/dd&#x27;</span>)),t <span class="hljs-keyword">AS</span> (<span class="hljs-keyword">SELECT</span> to_char(first_time,<span class="hljs-string">&#x27;yyyy/mm/dd&#x27;</span>) time_day,to_number(to_char(first_time,<span class="hljs-string">&#x27;hh24&#x27;</span>)) time_hour <span class="hljs-keyword">FROM</span> v$log_history lh <span class="hljs-keyword">WHERE</span> lh.FIRST_TIME <span class="hljs-operator">&gt;=</span>trunc(SYSDATE)<span class="hljs-number">-92</span>)<span class="hljs-keyword">SELECT</span> t.time_day,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h0,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h1 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h2,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">3</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h3 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">4</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h4 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">4</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h5 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">6</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h6 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">7</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h7 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">8</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h8 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h9 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">10</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h10 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">11</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h11 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">12</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h12 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">13</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h13 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">14</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h14 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">15</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h15 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">16</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h16 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">17</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h17 ,<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">18</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h18 , <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">19</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h19 , <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">20</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h20 , <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">21</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h21 , <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">22</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h22 , <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> t.time_hour<span class="hljs-operator">=</span><span class="hljs-number">23</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) h23 , ROUND(<span class="hljs-built_in">COUNT</span>(t.time_hour)<span class="hljs-operator">/</span><span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span>(t.time_hour))) AVG,<span class="hljs-built_in">max</span>(t1.size_gb) total_gb<span class="hljs-keyword">FROM</span> t,t1 <span class="hljs-keyword">WHERE</span> t.time_day<span class="hljs-operator">=</span>t1.time_day <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t.time_day <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t.time_day <span class="hljs-keyword">DESC</span>;</code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>使用permission.pl脚本修复节点文件权限</title>
    <link href="/2021/07/07/%E4%BD%BF%E7%94%A8permission-pl%E8%84%9A%E6%9C%AC%E4%BF%AE%E5%A4%8D%E8%8A%82%E7%82%B9%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/"/>
    <url>/2021/07/07/%E4%BD%BF%E7%94%A8permission-pl%E8%84%9A%E6%9C%AC%E4%BF%AE%E5%A4%8D%E8%8A%82%E7%82%B9%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/</url>
    
    <content type="html"><![CDATA[<blockquote><p><code>Script to capture and restore file permission in a directory (for eg. ORACLE_HOME) (Doc ID 1515018.1)</code></p><p>问题描述：RAC两个节点中，在节点2执行了<code>chown -R oracle:oinstall /u01</code> 导致节点2 文件权限不对，集群状态异常</p><p>解决办法：通过官方提供的 <code>permission.pl</code> 脚本进行修复</p></blockquote><ol><li>校验节点2权限问题</li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"># 校验失败，说明权限有异常[grid<span class="hljs-variable">@rac2</span> <span class="hljs-operator">~</span>]$ cluvfy comp software <span class="hljs-operator">-</span>n <span class="hljs-keyword">all</span> <span class="hljs-operator">-</span>verboseVerifying software<span class="hljs-keyword">Check</span>: Software<span class="hljs-number">3162</span> files verifiedSoftware <span class="hljs-keyword">check</span> failedVerification <span class="hljs-keyword">of</span> software was failed.</code></pre></div><ol start="2"><li>1节点执行修复脚本</li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"># 以root用户执行.<span class="hljs-operator">/</span>permission.pl <span class="hljs-operator">&lt;</span>Path name <span class="hljs-keyword">to</span> capture permission<span class="hljs-operator">&gt;</span>[root<span class="hljs-variable">@rac1</span> u01]# .<span class="hljs-operator">/</span>permission.pl <span class="hljs-operator">/</span>u01<span class="hljs-operator">/</span>.........Following log files <span class="hljs-keyword">are</span> generatedlogfile      : permission<span class="hljs-operator">-</span>Wed<span class="hljs-operator">-</span>Jul<span class="hljs-number">-07</span><span class="hljs-number">-10</span><span class="hljs-number">-21</span><span class="hljs-number">-13</span><span class="hljs-number">-2021</span>Command file : restore<span class="hljs-operator">-</span>perm<span class="hljs-operator">-</span>Wed<span class="hljs-operator">-</span>Jul<span class="hljs-number">-07</span><span class="hljs-number">-10</span><span class="hljs-number">-21</span><span class="hljs-number">-13</span><span class="hljs-number">-2021.</span>cmdLinecount : <span class="hljs-number">62264</span>[root<span class="hljs-variable">@rac1</span> u01]# ls <span class="hljs-operator">-</span>lrttotal <span class="hljs-number">17556</span>drwxrwxr<span class="hljs-operator">-</span>x. <span class="hljs-number">7</span> grid oinstall     <span class="hljs-number">4096</span> Jan <span class="hljs-number">27</span> <span class="hljs-number">16</span>:<span class="hljs-number">14</span> softdrwxr<span class="hljs-operator">-</span>xr<span class="hljs-operator">-</span>x  <span class="hljs-number">6</span> root oinstall       <span class="hljs-number">66</span> Jan <span class="hljs-number">28</span> <span class="hljs-number">12</span>:<span class="hljs-number">34</span> app<span class="hljs-operator">-</span>rwxr<span class="hljs-operator">-</span>xr<span class="hljs-operator">-</span>x  <span class="hljs-number">1</span> root root         <span class="hljs-number">2451</span> Mar <span class="hljs-number">31</span> <span class="hljs-number">18</span>:<span class="hljs-number">08</span> permission.pl<span class="hljs-operator">-</span>rw<span class="hljs-operator">-</span>r<span class="hljs-comment">--r--  1 root root     11869417 Jul  7 10:22 restore-perm-Wed-Jul-07-10-21-13-2021.cmd</span><span class="hljs-operator">-</span>rw<span class="hljs-operator">-</span>r<span class="hljs-comment">--r--  1 root root      6098198 Jul  7 10:22 permission-Wed-Jul-07-10-21-13-2021</span></code></pre></div><p>在当前目录下会生成两个文件:</p><p>a. <strong>permission-<time stamp></strong> - This contains file permission in octal value, owner and group information of the files captured<br>b. <strong>restore-perm-<time stamp>.cmd</strong> - This contains command to change the permission, owner, and group of the captured files</p><ol start="3"><li>将生成的两个文件拷贝到2节点</li></ol><div class="hljs code-wrapper"><pre><code class="hljs subunit">[root@rac1 u01]# scp permission-Wed-Jul<span class="hljs-string">-07</span><span class="hljs-string">-09</span><span class="hljs-string">-41</span><span class="hljs-string">-25</span><span class="hljs-string">-2021</span> root@rac2:/u01[root@rac1 u01]# scp restore-perm-Wed-Jul<span class="hljs-string">-07</span><span class="hljs-string">-09</span><span class="hljs-string">-41</span><span class="hljs-string">-25</span><span class="hljs-string">-2021</span>.cmd root@rac2:/u01/</code></pre></div><ol start="4"><li>修改<code>restore-perm-&lt;time stamp&gt;.cmd</code>中的信息</li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql"># 需要修改主机名、数据库实例名、ASM实例名[root<span class="hljs-variable">@rac2</span> u01]$ vi restore<span class="hljs-operator">-</span>perm<span class="hljs-operator">-</span>Wed<span class="hljs-operator">-</span>Jul<span class="hljs-number">-07</span><span class="hljs-number">-09</span><span class="hljs-number">-41</span><span class="hljs-number">-25</span><span class="hljs-number">-2021.</span>cmd:<span class="hljs-operator">%</span>s<span class="hljs-operator">/</span>rac1<span class="hljs-operator">/</span>rac2<span class="hljs-operator">/</span>g:<span class="hljs-operator">%</span>s<span class="hljs-operator">/</span>racdb1<span class="hljs-operator">/</span>racdb2<span class="hljs-operator">/</span>g:<span class="hljs-operator">%</span>s<span class="hljs-operator">/</span>ASM1<span class="hljs-operator">/</span>ASM2<span class="hljs-operator">/</span>g:<span class="hljs-operator">%</span>s<span class="hljs-operator">/</span>asm1<span class="hljs-operator">/</span>asm2<span class="hljs-operator">/</span>g# 赋予<span class="hljs-number">755</span>权限[root<span class="hljs-variable">@rac2</span> u01]# chmod <span class="hljs-number">755</span> restore<span class="hljs-operator">-</span>perm<span class="hljs-operator">-</span>Wed<span class="hljs-operator">-</span>Jul<span class="hljs-number">-07</span><span class="hljs-number">-09</span><span class="hljs-number">-41</span><span class="hljs-number">-25</span><span class="hljs-number">-2021.</span>cmd</code></pre></div><ol start="5"><li>以root用户执行<code>restore-perm-&lt;time stamp&gt;.cmd</code>文件</li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql">[root<span class="hljs-variable">@rac2</span> u01]# .<span class="hljs-operator">/</span>restore<span class="hljs-operator">-</span>perm<span class="hljs-operator">-</span>Wed<span class="hljs-operator">-</span>Jul<span class="hljs-number">-07</span><span class="hljs-number">-09</span><span class="hljs-number">-41</span><span class="hljs-number">-25</span><span class="hljs-number">-2021.</span>cmd</code></pre></div><p>屏幕输出中会有<code>chown</code>和<code>chmod</code>报错，主要原因为一些日志文件不存在引起</p><ol start="6"><li>重启主机或集群</li></ol><div class="hljs code-wrapper"><pre><code class="hljs sql">[grid<span class="hljs-variable">@rac2</span> <span class="hljs-operator">~</span>]$ crsctl stat res <span class="hljs-operator">-</span>t<span class="hljs-comment">--------------------------------------------------------------------------------</span>NAME           TARGET  STATE        SERVER                   STATE_DETAILS<span class="hljs-comment">--------------------------------------------------------------------------------</span><span class="hljs-keyword">Local</span> Resources<span class="hljs-comment">--------------------------------------------------------------------------------</span>ora.ARCH.dg               ONLINE  ONLINE       rac1               ONLINE  ONLINE       rac2ora.CRS.dg               ONLINE  ONLINE       rac1               ONLINE  ONLINE       rac2ora.DATA.dg               ONLINE  ONLINE       rac1               ONLINE  ONLINE       rac2ora.LISTENER.lsnr               ONLINE  ONLINE       rac1               ONLINE  ONLINE       rac2ora.asm               ONLINE  ONLINE       rac1                     Started               ONLINE  ONLINE       rac2                     Startedora.gsd               OFFLINE OFFLINE      rac1               OFFLINE OFFLINE      rac2ora.net1.network               ONLINE  ONLINE       rac1               ONLINE  ONLINE       rac2ora.ons               ONLINE  ONLINE       rac1               ONLINE  ONLINE       rac2<span class="hljs-comment">--------------------------------------------------------------------------------</span>Cluster Resources<span class="hljs-comment">--------------------------------------------------------------------------------</span>ora.LISTENER_SCAN1.lsnr      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac1ora.cvu      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac1ora.oc4j      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac1ora.rac1.vip      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac1ora.rac2.vip      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac2ora.racdb.db      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac1                     <span class="hljs-keyword">Open</span>      <span class="hljs-number">2</span>        ONLINE  ONLINE       rac2                     <span class="hljs-keyword">Open</span>ora.scan1.vip      <span class="hljs-number">1</span>        ONLINE  ONLINE       rac1[grid<span class="hljs-variable">@rac2</span> <span class="hljs-operator">~</span>]$</code></pre></div><hr><h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>权限修复成功的前提是必须有一个节点的权限是正常的，否则无法通过此方式进行修复</p>]]></content>
    
    
    <categories>
      
      <category>ORACLE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RAC</tag>
      
      <tag>修复</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>公告</title>
    <link href="/2021/05/30/%E5%85%AC%E5%91%8A/"/>
    <url>/2021/05/30/%E5%85%AC%E5%91%8A/</url>
    
    <content type="html"><![CDATA[<p>临近毕业</p><p>事有点多</p><p>暂停更新</p>]]></content>
    
    
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>about</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<p>手无缚鸡之力_</p>]]></content>
    
  </entry>
  
  
  
</search>
